#!/usr/bin/env bash
set -euo pipefail

echo
echo "========================================"
echo "       GITKEY-INSTALL (install en local)"
echo "========================================"
echo

# ┌───────────────────────────────────────────────────────────────────────────┐
# │ (A) Demander immédiatement vos identifiants GitHub                      │
# └───────────────────────────────────────────────────────────────────────────┘
read -p "Nom d’utilisateur GitHub : " GITHUB_USER
read -s -p "Mot de passe ou token GitHub : " GITHUB_TOKEN
echo
echo "→ Identifiants saisis (le token reste masqué)."
echo

# ┌───────────────────────────────────────────────────────────────────────────┐
# │ (B) Enregistrer ces credentials dans /root/.neomnia/credentials.conf     │
# │     (car on tourne en root)                                              │
# └───────────────────────────────────────────────────────────────────────────┘
CONFIG_DIR="/root/.neomnia"
mkdir -p "$CONFIG_DIR"
cat > "$CONFIG_DIR/credentials.conf" <<EOF
GITHUB_USER="$GITHUB_USER"
GITHUB_TOKEN="$GITHUB_TOKEN"
EOF
echo "→ Credentials enregistrés dans $CONFIG_DIR/credentials.conf."
echo

# ┌───────────────────────────────────────────────────────────────────────────┐
# │ (C) Poursuivre la suite de l’installation en local                        │
# │     (Exemple: cloner un autre repo, copier des fichiers systemd, etc.)   │
# └───────────────────────────────────────────────────────────────────────────┘
# Ici, vous pouvez ajouter toutes les commandes complémentaires dont vous avez besoin.
# Par exemple :
#   git clone https://github.com/mon-orga/mon-projet.git /opt/mon-projet
#   cp /opt/mon-projet/service.conf /etc/systemd/system/mon-service.service
#   systemctl daemon-reload
#   systemctl enable mon-service
#   systemctl start mon-service
#
# Pour l’instant, on se contente d’un message de succès :
echo "🎉 Installation locale terminée avec succès."
exit 0
